(this["webpackJsonpspotify-favourites"]=this["webpackJsonpspotify-favourites"]||[]).push([[6],{278:function(e,t,n){},283:function(e,t,n){"use strict";n.r(t);var r=n(87),o=n(0),a=n.n(o),c=n(42),i=n(81),u=(n(278),n(56)),s=function(){var e=!Object(o.useContext)(u.a).spotifyPlayerState.paused;return a.a.createElement("div",{className:"player"},e?a.a.createElement("div",{onClick:function(){Object(i.a)()}},"Pause"):a.a.createElement("div",{onClick:function(){Object(i.b)()}},"Play"))},f=function(){var e=document.createElement("script");return e.async=!0,e.src="https://sdk.scdn.co/spotify-player.js",document.body.appendChild(e),e};t.default=function(){var e=Object(o.useContext)(u.a),t=e.setDeviceId,n=e.setSpotifyPlayerState,p=e.trackHistory,d=e.setTrackHistory;return Object(o.useEffect)((function(){var e=f();return window.onSpotifyWebPlaybackSDKReady=function(){var e=Object(c.b)(),o=new Spotify.Player({name:"Spotify Favourites Web Player",getOAuthToken:function(t){t(e)}});o.addListener("initialization_error",(function(e){var t=e.message;console.error(t)})),o.addListener("authentication_error",(function(e){var t=e.message;console.error(t)})),o.addListener("account_error",(function(e){var t=e.message;console.error(t)})),o.addListener("playback_error",(function(e){var t=e.message;console.error(t)})),o.addListener("player_state_changed",(function(e){console.log(e),n(e),function(e){console.log("trackHistory ",p);var t=Object(r.a)(p);console.log("newTrackHistory ",t);var n=!1;p.forEach((function(t){t.uri===e.uri&&(n=!0)})),n||(t.push(e),d(t))}(e.track_window.current_track)})),o.addListener("ready",(function(e){var n=e.device_id;console.log("Ready with Device ID",n),Object(i.d)(n),t(n)})),o.addListener("not_ready",(function(e){var t=e.device_id;console.log("Device ID has gone offline",t)})),o.connect()},function(){document.body.removeChild(e)}}),[]),a.a.createElement(s,null)}},42:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return h}));var r,o=n(44),a=n.n(o),c=n(46),i=n(50),u=n(57),s=n(78),f=n(79),p="https://rowsim.github.io/spotify-favourites/callback",d="a3c9a895bbe94102a08574ba4f4adc9e";!function(e){e.AUTH="authorization_code",e.REFRESH="refresh_token"}(r||(r={}));var l=function(){var e=Object(c.a)(a.a.mark((function e(){var t,n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u({length:48,type:"url-safe"}),localStorage.setItem("verifierCode",t),e.t0=v,e.next=5,s(t);case 5:return e.t1=e.sent,n=(0,e.t0)(e.t1),r=u({length:10,type:"url-safe"}),localStorage.setItem("stateCode",r),e.abrupt("return","https://accounts.spotify.com/authorize?response_type=code&client_id=".concat(d,"&redirect_uri=").concat(p,"&code_challenge_method=S256&code_challenge=").concat(n,"&state=").concat(r,"&scope=").concat("user-top-read streaming"));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(i.a)("spotifyToken");return e||(h(r.REFRESH)?localStorage.getItem("spotifyRefreshToken"):null)},h=function(){var e=Object(c.a)(a.a.mark((function e(t,n,o){var c,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==r.REFRESH){e.next=5;break}return c={grant_type:t,refresh_token:localStorage.getItem("spotifyRefreshToken"),client_id:d},e.abrupt("return",b(c));case 5:if(localStorage.getItem("stateCode")!==n){e.next=10;break}return i={client_id:d,grant_type:t,code:o,redirect_uri:p,code_verifier:localStorage.getItem("verifierCode")},e.next=9,b(i);case 9:return e.abrupt("return",e.sent);case 10:return e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),b=function(){var e=Object(c.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://accounts.spotify.com/api/token",{method:"POST",body:m(t),headers:{"Content-Type":"application/x-www-form-urlencoded"}});case 2:return n=e.sent,e.next=5,n.json();case 5:if(!(r=e.sent).access_token){e.next=10;break}return Object(i.b)("spotifyToken",r.access_token,r.expires_in),localStorage.setItem("spotifyRefreshToken",r.refresh_token),e.abrupt("return",!0);case 10:return e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(e){return e.toString(f).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},m=function(e){return Object.keys(e).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&")}},60:function(e,t){},61:function(e,t){},64:function(e,t){},65:function(e,t){},67:function(e,t){},68:function(e,t){},69:function(e,t){},70:function(e,t){},71:function(e,t){},73:function(e,t){},74:function(e,t){},76:function(e,t){},77:function(e,t){},81:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return f})),n.d(t,"d",(function(){return p}));var r=n(44),o=n.n(r),a=n(46),c=n(42),i="https://api.spotify.com/v1/me/player",u=function(){var e=Object(a.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(c.b)(),fetch("".concat(i,"/play"),{method:"PUT",headers:{Authorization:"Bearer ".concat(n)},body:JSON.stringify({uris:t})});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=function(){var e=Object(a.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(c.b)(),fetch("".concat(i,"/play"),{method:"PUT",headers:{Authorization:"Bearer ".concat(t)}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=Object(a.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(c.b)(),fetch("".concat(i,"/pause"),{method:"PUT",headers:{Authorization:"Bearer ".concat(t)}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=Object(a.a)(o.a.mark((function e(t){var n,r,a=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=a.length>1&&void 0!==a[1]&&a[1],r=Object(c.b)(),fetch(i,{method:"PUT",headers:{Authorization:"Bearer ".concat(r)},body:JSON.stringify({device_ids:[t],play:n})});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},87:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(11);var o=n(17);function a(e){return function(e){if(Array.isArray(e))return Object(r.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(o.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}}]);
//# sourceMappingURL=6.2f9d3ebf.chunk.js.map